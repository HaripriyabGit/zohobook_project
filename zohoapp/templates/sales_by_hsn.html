{% extends 'base3.html' %}
{% block content %}
{% load static %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
    .filter-dropdown {
        display: none;
        position: absolute;
        background: white;
        border: 1px solid #ccc;
        padding: 10px;
        z-index: 1;
        border-radius: 10%;
    }
    .filter-option,
    .filter-value {
        width: 100%;
        padding: 5px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 1px;
    }

    .filter-buttons {
        display: flex;
        justify-content: space-between;
    }

    .filter-buttons button {
        padding: 8px 15px;
        border: none;
        border-radius: 3px;
        cursor: pointer;
    }

    .apply-filter {
        background-color: #4caf50;
        color: white;
    }

    .clear-filter {
        background-color: #f44336;
        color: white;
    }
    table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
  color: #333;

}

th, td,tr {
  padding: 10px;
  text-align: center;
 border: 1px solid #333;
}

thead {
  color: #fff;
}
</style>
<br> 
 <div class="container-fulid" style="height:2% ;">
 <nav class="nav nav-pills navbar-expand-lg navbar-light " id="navabars">
  <!-- Navbar brand or logo -->
  <a class="navbar-brand" href="#"></a>
  
  <!-- Navbar content -->
  
         

  <li class="nav-item " style="padding-left:1000px ;">
    <a class="nav-link "  href="#" role="button" aria-expanded="false" style="background: white; color: black;width: 5%;"  onclick="printPageContent()"><i class="fas fa-print"style="color:black;transform: translateX(-40%);"></i></a>

      

  </li>


  <li class="nav-item " style="padding-left:10px ;">
    <a class="nav-link " id="" href="#" role="button" aria-expanded="false" style="background: white; color: black;width:5%;"  onclick="exportAsExcel()"><i class="fas fa-file-excel" style="color:black;transform: translateX(-40%);"></i></a>

    
  </li>
           <li class="nav-item">
            <input type="button" value="X" onclick="javascript:history.go(-1);" class="btn btn-tansperent" style="font-size: 20px;"> 
       
           </li>
      </ul>
  </div>
</nav>
<br><br><br>
<div id="contentToExport">
    <div  style="top: 7rem; " >
  

          <div class="row" >
              <div class="col">
                <div class="table-resposive">
                  <table class="table" id="myTable" style="width: 100%;">
                      <thead class="">
                        
                        <tr class="">
                            <th class="table">#</th>
                          <th class="table" >HSN<i class="fas fa-filter filter-button" style="color: red;"></i>
                            <div class="filter-dropdown">
                                <select class="filter-option">
                                    <option value="contains">Contains</option>
                                    <option value="exact-match">Exact Match</option>
                                </select><br><br>
                                <input type="text" class="filter-value" ><br><br>
                                <button class="apply-filter btn-primary">Apply</button>
                                <button class="clear-filter">Clear</button>
                            </div>
                            
                        </th>
                          <th class="table">TOTAL VALUE <i class="fas fa-filter"style="color:red"></i>
                            <div class="filter-dropdown">
                                <select class="filter-option">
                                    <option value="equal-to">Equal to</option>
                                    <option value="less-than">Less than</option>
                                    <option value="greater-than">Greater than</option>
                                </select>
                                <input type="number" class="filter-value" placeholder="Enter value">
                                <div class="filter-buttons">
                                    <button class="apply-filter">Apply</button>
                                    <button class="clear-filter">Clear</button>
                                </div>
                            </div>
                        
                        </th>
                          <th class="table">TAXABLE VALUE <i class="fas fa-filter"style="color:red"></i></th>
                          <th class="table">IGST AMOUNT <i class="fas fa-filter"style="color:red"></i></th>
                          <th class="table">CGST AMOUNT <i class="fas fa-filter"style="color:red"></i></th>
                          <th class="table">SGST AMOUNT <i class="fas fa-filter"style="color:red"></i></th>
                          <th class="table">ADD.CESS <i class="fas fa-filter"style="color:red"></i></th>

                      
                        </tr>
                       
                      </thead>
                      <tbody>
                       
                        {%for i in items %}
                        <tr id="over" class="table">
               
                       
                          <td class="">{{i.id}}</td>
                          <td class="">{{i.hsn}}</td>
                          <td class="">{% for p in invoice %}{{p.subtotal}}{%endfor%}</td>
                          <td class="">{% for p in invoice %}{{p.grandtotal}}{%endfor%}</td>
                          <td class="">{% for p in invoice %}{{p.igst}}{%endfor%}</td>
                          <td class="">{% for p in invoice %}{{p.cgst}}{%endfor%}</td>
                          <td class="">{% for p in invoice %}{{p.sgst}}{%endfor%}</td>
                          <td class="">0</td>
                          
  
                        </tr>
                        {%endfor%}
                  
              
                   
                      </tbody>
                      
                  </table>
        


                  <script>
                    $(document).ready(function() {
                        $('.filter-button').on('click', function() {
                            // Toggle filter dropdown visibility
                            $(this).closest('th').find('.filter-dropdown').toggle();
                        });
                
                        $('.apply-filter').on('click', function() {
                            const filterOption = $(this).siblings('.filter-option').val();
                            const filterValue = $(this).siblings('.filter-value').val().trim();
                
                            $('#myTable tbody tr').each(function() {
                                const cellText = $(this).find('.td').text();
                
                                if (filterOption === 'contains') {
                                    if (cellText.includes(filterValue)) {
                                        $(this).show();
                                    } else {
                                        $(this).hide();
                                    }
                                } else if (filterOption === 'exact-match') {
                                    if (cellText === filterValue) {
                                        $(this).show();
                                    } else {
                                        $(this).hide();
                                    }
                                }
                            });
                        });
                
                        $('.clear-filter').on('click', function() {
                            $('#myTable tbody tr').show();
                            $(this).siblings('.filter-option').val('contains');
                            $(this).siblings('.filter-value').val('');
                        });
                    });
                </script>
               
               <!-- <script>
                    $(document).ready(function() {
                        $('.filter-button').on('click', function() {
                            // Toggle filter dropdown visibility
                            $(this).closest('th').find('.filter-dropdown').toggle();
                        });
                
                        $('.apply-filter').on('click', function() {
                            const filterOption = $(this).siblings('.filter-option').val();
                            const filterValue = parseFloat($(this).siblings('.filter-value').val());
                
                            $('#myTable tbody tr').each(function() {
                                const cellText = $(this).find('.td').text();
                                const cellValue = parseFloat(cellText);
                
                                if (filterOption === 'equal-to') {
                                    if (cellValue === filterValue) {
                                        $(this).show();
                                    } else {
                                        $(this).hide();
                                    }
                                } else if (filterOption === 'less-than') {
                                    if (cellValue < filterValue) {
                                        $(this).show();
                                    } else {
                                        $(this).hide();
                                    }
                                } else if (filterOption === 'greater-than') {
                                    if (cellValue > filterValue) {
                                        $(this).show();
                                    } else {
                                        $(this).hide();
                                    }
                                }
                            });
                        });
                
                        $('.clear-filter').on('click', function() {
                            $('#myTable tbody tr').show();
                            $(this).siblings('.filter-option').val('equal-to');
                            $(this).siblings('.filter-value').val('');
                        });
                    });
                </script>











 -->
 <script>
    function printPageContent() {
      const contentToPrint = document.getElementById('contentToExport');
      const clonedContent = contentToPrint.cloneNode(true);
  
      // Find all the elements with the class "text" within the cloned content
      const textElements = clonedContent.querySelectorAll('.text');
      const tableElements = clonedContent.querySelectorAll('.table');
  
      // Set the text color to black for each element with the class "text"
      textElements.forEach(element => {
        element.style.color = '#000000';  // Text color (black)
      });
      tableElements.forEach(element => {
        element.style.color = '#000000';
        element.style.border ='1px solid';
        
      });
  
      // Print the cloned content
      const printWindow = window.open('', '_blank');
      printWindow.document.body.appendChild(clonedContent);
      printWindow.print();
      printWindow.close();
    }
  </script>

{%endblock%}